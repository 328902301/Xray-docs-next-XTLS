<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.2">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/logo.png"><title>Transparent proxy via GID | Project X</title><meta name="description" content="Official document of Xray">
    <link rel="preload" href="/Xray-docs-next/assets/style--_jpjXCu.css" as="style"><link rel="stylesheet" href="/Xray-docs-next/assets/style--_jpjXCu.css">
    <link rel="modulepreload" href="/Xray-docs-next/assets/app-U4p-MjZo.js"><link rel="modulepreload" href="/Xray-docs-next/assets/iptables_gid.html-chRdnVmo.js"><link rel="modulepreload" href="/Xray-docs-next/assets/iptables_gid.html-n-Ms4XUY.js">
    <link rel="prefetch" href="/Xray-docs-next/assets/index.html-p2c5C4AU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/news.html-pwjcoGoO.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-z9NWHqlp.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-XFyzJ1xl.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/api.html-WGzp5ZHY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-M7PqPYo9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fakedns.html-wHw6FjrC.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/inbound.html-moDGVb2O.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/log.html-e7hnT2bq.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/metrics.html-9VuoOtoJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/outbound.html-wShrwo1r.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/policy.html-5wXUoyYU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/reverse.html-iCYMdXOv.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing.html-z5FZ8_MJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/stats.html-sE2S72lW.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transport.html-N174p-f4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-E6Im5Z2U.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/command.html-zok3YKap.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/config.html-aUjThaBl.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/document.html-T74UyKyv.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/install.html-HJ0OvsaV.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-Heqmc6Jh.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/compile.html-X6FgGIuq.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/design.html--gTpLkem.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/guide.html-9aEFcVqM.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-vo5PDXHA.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/muxcool.html-nTSzbowY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-qQ4zG4ni.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-VN98TXTo.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/browser_dialer.html-pBajOlNq.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/env.html-cjIQiZYK.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallback.html-1JIS-sqn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/multiple.html-g48N6K0K.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/xtls.html-B_w95T3t.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dokodemo.html-jpQVDK5E.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-kcI8nPMj.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-RfXFYESa.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-s5-aPzb4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-1a6tGxlx.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-8KqB5qGc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-YK_H6TQs.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/blackhole.html-KHhjSI5O.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-gJ4v9Hez.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/freedom.html-bKrcmvMl.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-ODrut9n2.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/loopback.html-ak_pY07v.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-coJ5pBTn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-y40g6uI5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-yXVZG2Ev.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-qqj9e8Vf.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-Vr1rc_Up.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/wireguard.html-KdrqTCQm.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/domainsocket.html-wdK_rHZQ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/grpc.html-LBqi_a75.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/h2.html-KM70GQbw.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/httpupgrade.html-H-WqXGti.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-0Xk_HIpn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/quic.html-m95M53yN.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tcp.html-jnCC9tdJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/websocket.html-MBy8EkDB.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-SzZckNsL.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch01-preface.html-tEScEaZz.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch02-preparation.html-RGVVF1aX.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch03-ssh.html-r0_Dxdy0.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch04-security.html-fTS70_mi.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch05-webpage.html-5seJ1ciw.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch06-certificates.html-S8wDl_Ux.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch07-xray-server.html-XceTyVhx.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch08-xray-clients.html-ud6w1qRW.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch09-appendix.html-sabgEttE.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-mMCfrUS-.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-lv1.html-77y0K8ky.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-with-sni.html-qQOZMYA7.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part1.html-cRNm4oEK.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part2.html-5XUPXSEg.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/work.html-145CR_fW.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-BFn1lRAW.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/iptables_gid.html-BjKdQK_Z.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/nginx_or_haproxy_tls_tunnel.html-_NqxTVZn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/redirect.html-ErNGzo9V.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy.html-y5eAJ7SY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy_ipv4_and_ipv6.html-JH4YyNOP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/traffic_stats.html-_cNOE5xN.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/warp.html-ijpv_-3K.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/news.html-gzJt0vYA.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-BGcfEeBc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/api.html-ehTB5jsP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-rP5naxFq.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fakedns.html-WRT-9j2m.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/inbound.html-Mx2-iGW_.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/log.html-p-vXJqMl.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/metrics.html-GccLQE2P.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/outbound.html-rUxUkwF-.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/policy.html-0ggCjnWf.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/reverse.html-Vyc-TBL8.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing.html-gMcV9QF8.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/stats.html-f0XRSzHJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transport.html-mllSCORh.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-JeZuqWwp.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-PAgbBg-Z.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/command.html-5rSGvvaL.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/config.html-5ZOPemlE.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/document.html-7QxaDrrB.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/install.html-bu0Ticvf.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transparent_proxy.html-ocawHfnS.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/browser_dialer.html-G4IRQ_Kg.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/env.html-vTGLOPHC.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallback.html-c3nG_SbK.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/multiple.html-broKJH6Q.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/xtls.html-VGwDVgWQ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dokodemo.html-lQ2ZCHA0.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-qlBUGI3d.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-KKd7sD5W.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-Rr3Pd7Z4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-JtWYvOGZ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-FmnaDhwB.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-DQRQNJRf.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/blackhole.html-wP8aOe1s.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-fsBpY6OJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/freedom.html-pEcHOOJi.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-ycpGlUVn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/loopback.html-ek6rG2JU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-DUgYYNSE.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-4LNnnGuU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-zPYE2Rnw.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-oJkCcWqP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-FLYSgYZF.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/wireguard.html-BNOcORO_.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/domainsocket.html-XJDOFjPR.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/grpc.html--7XYo6-r.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/h2.html-an3IPz3A.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/httpupgrade.html-pqcUDxzH.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-KaKSugGP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/quic.html-tQfatAaD.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tcp.html-D0BFi51s.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/websocket.html-u5FN1LVg.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/compile.html-v0FcVQeh.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/design.html-mn37DqeY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/guide.html-uQWUSL0p.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-uyvLxsmR.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/muxcool.html-dKJnlJKP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-oFhH_CKR.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-tRW4iV5D.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-epCgXVFP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch01-preface.html-EhjqE-xm.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch02-preparation.html-vmCsE7AE.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch03-ssh.html-7SR0w9_k.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch04-security.html-AXaKPt5U.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch05-webpage.html-sRW5SJR3.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch06-certificates.html-nx5r2spW.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch07-xray-server.html-d6fAFDtx.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch08-xray-clients.html--7VTUdFB.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch09-appendix.html-ocawR_gn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-9tqrbw4-.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-lv1.html-Ue5QjCC2.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-with-sni.html-L4x-DI-J.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part1.html-uWcVLGTr.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part2.html-77qV5nP4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/work.html-DIaUDWrM.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-6shuNL--.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/nginx_or_haproxy_tls_tunnel.html-0TxfRNOy.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/redirect.html-FhWJ2sky.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy.html-ad4fKtf9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy_ipv4_and_ipv6.html-kIWOgIT3.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/traffic_stats.html-o6SE99UZ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/warp.html-4hKe1jqm.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transparent_proxy.html-LpjOlZS3.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/404.html-r6aI8Oiv.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-xFmxzlKU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/news.html-NGx_jL40.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-ysnpMTNB.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-Exq73BtJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/api.html-oxp62NVF.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-KWpsnR7W.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fakedns.html-49RCXVWr.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/inbound.html-LQ0tBEU0.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/log.html-WPzrGp-L.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/metrics.html-LzIVpo3t.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/outbound.html-g10gmYwx.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/policy.html-D4zFXP0s.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/reverse.html-PX2Cphyu.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing.html-Uj7rcg4y.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/stats.html-syxGrkXn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transport.html-S0JdKRCs.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-Ym-e4-I2.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/command.html-vkDmM3jT.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/config.html-BBP_2Gby.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/document.html-LowF1CeD.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/install.html-gaoDbLsu.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-CwbQ8z_y.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/compile.html-VBNHa9a6.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/design.html-Gy5SBNX5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/guide.html-8G27TDh4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-14A7B9G_.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/muxcool.html-zwY0Hcxs.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-5DlLQITQ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-XDF0Kw2d.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/browser_dialer.html-XkTdDVEQ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/env.html-UTyA6Fn6.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallback.html-ZD32VQQ9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/multiple.html-2RWfAPTy.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/xtls.html-iG75iNal.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dokodemo.html-_P17dHqX.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-RoifODVi.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-wQhltUqV.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-7HDIukD-.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-QPLtchr5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-F1dtWDGl.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-1J1DsYBg.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/blackhole.html-KtHRPwfd.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-Wbrdr6FI.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/freedom.html-IwMWlmG7.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-ab1jZDEv.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/loopback.html-kixRkgKp.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-U_DFc7Ks.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-cL-0wYIy.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-aBJ8fNoc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-A-n1mnnY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-CRnvAaFY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/wireguard.html-RmCJXbRZ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/domainsocket.html-QQK9FIv9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/grpc.html-UV8M4hKU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/h2.html-gImdix4E.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/httpupgrade.html-s6_yNihC.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-Uko8AtZ6.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/quic.html-RZQceQRh.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tcp.html-8FjUykO9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/websocket.html-pAi2eypd.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-71BqXjF7.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch01-preface.html-igAUFBtA.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch02-preparation.html-92DSKNMY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch03-ssh.html-tq9N0C10.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch04-security.html-druDegqU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch05-webpage.html-4_OKzmp7.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch06-certificates.html-5eUCrJF6.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch07-xray-server.html-K6EhibJb.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch08-xray-clients.html-EoVMQRrc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch09-appendix.html-GejSkoEI.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-TnLivYyC.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-lv1.html-ZcJDG6S3.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-with-sni.html-WQS5LUE6.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part1.html-yCrN4jrf.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part2.html-M1Enm3Gh.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/work.html-b6Wsq7lE.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-uNBR4a-M.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/iptables_gid.html-Rc-HLokj.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/nginx_or_haproxy_tls_tunnel.html-bjAkb7cm.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/redirect.html-pbItFLXT.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy.html-mUVRMcNY.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy_ipv4_and_ipv6.html--KSwRPMl.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/traffic_stats.html-MXT6T3oH.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/warp.html-Tu78bKtp.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/news.html-dl67VKiF.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-XVe1ShMv.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/api.html-HRfGKrse.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-AaE7rmUa.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fakedns.html-_WyXa1SG.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/inbound.html-eY_ZfxiK.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/log.html-8exS_D-i.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/metrics.html-2t1KEDx_.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/outbound.html-QYIifsI9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/policy.html-WLu0955I.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/reverse.html-HtRajnqr.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing.html-ox9l4km3.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/stats.html-biflpgEe.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transport.html-2g8XzKqT.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-wWWYMYkJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-Tk5H7Hfs.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/command.html-fiW2KhfO.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/config.html-MHwBQMpx.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/document.html-pYjiQI21.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/install.html-RqPJKOFD.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transparent_proxy.html-O_VA4EmQ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/browser_dialer.html-D7H2T9Tn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/env.html-2AAY7kjO.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallback.html-LHAdfo9Q.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/multiple.html-g5YaCNEU.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/xtls.html-tNVH8WoQ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dokodemo.html-19Y-B415.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-lnXGBoHT.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-HtZ04IA5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-PFP819ka.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-kHsQzr2L.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-_R9FrxSt.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-lPzqoOtN.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/blackhole.html-Zs8D5s5Q.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/dns.html-W0dWp-pJ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/freedom.html-EwPMiQXP.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/http.html-GhhaFMoq.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/loopback.html-8Q8wrUHO.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/shadowsocks.html-yLdTgYCT.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/socks.html-JBUHE4mO.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/trojan.html-L7LE8ISc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-p9HjDI81.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-DZTUCTyL.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/wireguard.html-vkZXfwjV.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/domainsocket.html-xGFMSD0j.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/grpc.html-sTM3i3qH.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/h2.html-tQmVhbuk.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/httpupgrade.html-_yd9AvZj.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-atCIk-ho.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/quic.html-12mwFEza.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tcp.html-6YYAiT2f.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/websocket.html-d5RV4SuA.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/compile.html-aajXtGva.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/design.html-Ewl_Ho_c.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/guide.html-CeIvjrLv.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/mkcp.html-ycX_OxZr.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/muxcool.html-3PW6-iHX.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vless.html-Rj1QKEBm.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/vmess.html-EFGMLLqB.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-mwWC0TZ5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch01-preface.html-vIBMLcxg.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch02-preparation.html-C7Itblqa.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch03-ssh.html-CAxwbsx9.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch04-security.html-Bomgy2OF.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch05-webpage.html-li_PRnnn.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch06-certificates.html-Hly1Y573.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch07-xray-server.html-ZYy3N_PZ.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch08-xray-clients.html-VXAYy1wr.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/ch09-appendix.html-vdyNCPS5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-kaT6SCz4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-lv1.html-5oXFkS9x.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/fallbacks-with-sni.html-2N2NCeAz.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part1.html-nUrGheLz.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/routing-lv1-part2.html-znlA_AT4.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/work.html-BJpWfWvc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/index.html-0vPq68fo.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/nginx_or_haproxy_tls_tunnel.html-Tqy0Q58Z.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/redirect.html-Gqsd40f5.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy.html-2khy5Iuq.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/tproxy_ipv4_and_ipv6.html-HWSlq_dc.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/traffic_stats.html-ktqUfsLS.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/warp.html-ueaT8k81.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/transparent_proxy.html-NmTcld2S.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/404.html-eZxZAx1n.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/Mermaid-GCPRVcLs.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/Tab-K50KDH_z.js" as="script"><link rel="prefetch" href="/Xray-docs-next/assets/Tabs-pabT4XK8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle side bar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/Xray-docs-next/en/" class=""><!----><span class="site-name" aria-hidden="true">Project X</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a href="/Xray-docs-next/en" class="router-link-active" aria-label="Homepage"><!--[--><!--]--> Homepage <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/about/news.md" class="" aria-label="Website History"><!--[--><!--]--> Website History <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/config/" class="" aria-label="Config Reference"><!--[--><!--]--> Config Reference <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/development/" class="" aria-label="Developer Guide"><!--[--><!--]--> Developer Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/document/" class="router-link-active" aria-label="Quick Start"><!--[--><!--]--> Quick Start <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Multiple language"><span class="title">Multiple language</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Multiple language"><span class="title">Multiple language</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/Xray-docs-next/document/level-2/iptables_gid.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English (WIP)"><!--[--><!--]--> English (WIP) <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/xtls/xray-core" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a href="/Xray-docs-next/en" class="router-link-active" aria-label="Homepage"><!--[--><!--]--> Homepage <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/about/news.md" class="" aria-label="Website History"><!--[--><!--]--> Website History <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/config/" class="" aria-label="Config Reference"><!--[--><!--]--> Config Reference <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/development/" class="" aria-label="Developer Guide"><!--[--><!--]--> Developer Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Xray-docs-next/en/document/" class="router-link-active" aria-label="Quick Start"><!--[--><!--]--> Quick Start <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Multiple language"><span class="title">Multiple language</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Multiple language"><span class="title">Multiple language</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/Xray-docs-next/document/level-2/iptables_gid.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English (WIP)"><!--[--><!--]--> English (WIP) <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/xtls/xray-core" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Quick Start <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Xray-docs-next/en/document/" class="router-link-active sidebar-item" aria-label="Quick Start"><!--[--><!--]--> Quick Start <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/install.html" class="sidebar-item" aria-label="Download and Install"><!--[--><!--]--> Download and Install <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/config.html" class="sidebar-item" aria-label="Configure and Run"><!--[--><!--]--> Configure and Run <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/command.html" class="sidebar-item" aria-label="Command Parameters"><!--[--><!--]--> Command Parameters <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/document.html" class="sidebar-item" aria-label="Contribute to Project X&#39;s Document"><!--[--><!--]--> Contribute to Project X&#39;s Document <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Beginner Tutorial <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Xray-docs-next/en/document/level-0/" class="sidebar-item" aria-label="Plain and Simple Language"><!--[--><!--]--> Plain and Simple Language <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch01-preface.html" class="sidebar-item" aria-label="[Chapter 1] Simple and Plain Language"><!--[--><!--]--> [Chapter 1] Simple and Plain Language <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch02-preparation.html" class="sidebar-item" aria-label="[Chapter 2] Preparation of Raw Materials"><!--[--><!--]--> [Chapter 2] Preparation of Raw Materials <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch03-ssh.html" class="sidebar-item" aria-label="[Chapter 3] Remote Login"><!--[--><!--]--> [Chapter 3] Remote Login <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch04-security.html" class="sidebar-item" aria-label="[Chapter 4] Security and Protection"><!--[--><!--]--> [Chapter 4] Security and Protection <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch05-webpage.html" class="sidebar-item" aria-label="Chapter 5: Website Building"><!--[--><!--]--> Chapter 5: Website Building <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch06-certificates.html" class="sidebar-item" aria-label="[Chapter 6] Certificate Management"><!--[--><!--]--> [Chapter 6] Certificate Management <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch07-xray-server.html" class="sidebar-item" aria-label="【第 7 章】Xray 服务器篇"><!--[--><!--]--> 【第 7 章】Xray 服务器篇 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch08-xray-clients.html" class="sidebar-item" aria-label="【第 8 章】Xray 客户端篇"><!--[--><!--]--> 【第 8 章】Xray 客户端篇 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-0/ch09-appendix.html" class="sidebar-item" aria-label="【第 9 章】附录"><!--[--><!--]--> 【第 9 章】附录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Getting Started Tips <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Xray-docs-next/en/document/level-1/" class="sidebar-item" aria-label="Beginner&#39;s Tips"><!--[--><!--]--> Beginner&#39;s Tips <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-1/fallbacks-lv1.html" class="sidebar-item" aria-label="回落 (fallbacks) 功能简析"><!--[--><!--]--> 回落 (fallbacks) 功能简析 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-1/routing-lv1-part1.html" class="sidebar-item" aria-label="路由 (routing) 功能简析（上）"><!--[--><!--]--> 路由 (routing) 功能简析（上） <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-1/routing-lv1-part2.html" class="sidebar-item" aria-label="路由 (routing) 功能简析（下）"><!--[--><!--]--> 路由 (routing) 功能简析（下） <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-1/work.html" class="sidebar-item" aria-label="Xray 的工作模式"><!--[--><!--]--> Xray 的工作模式 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-1/fallbacks-with-sni.html" class="sidebar-item" aria-label="SNI fallback"><!--[--><!--]--> SNI fallback <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Advanced Documentation <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Xray-docs-next/en/document/level-2/" class="router-link-active sidebar-item" aria-label="Advanced Documentation"><!--[--><!--]--> Advanced Documentation <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-2/transparent_proxy/transparent_proxy.html" class="sidebar-item" aria-label="透明代理入门"><!--[--><!--]--> 透明代理入门 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-2/tproxy.html" class="sidebar-item" aria-label="TProxy 透明代理"><!--[--><!--]--> TProxy 透明代理 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-2/tproxy_ipv4_and_ipv6.html" class="sidebar-item" aria-label="TProxy 透明代理 (ipv4 and ipv6)"><!--[--><!--]--> TProxy 透明代理 (ipv4 and ipv6) <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-2/nginx_or_haproxy_tls_tunnel.html" class="sidebar-item" aria-label="Nginx 或 Haproxy 搭建 TLS 隧道隐藏指纹"><!--[--><!--]--> Nginx 或 Haproxy 搭建 TLS 隧道隐藏指纹 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Transparent proxy via GID"><!--[--><!--]--> Transparent proxy via GID <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#ideas" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ideas"><!--[--><!--]--> Ideas <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#configuration-procedure" class="router-link-active router-link-exact-active sidebar-item" aria-label="Configuration Procedure"><!--[--><!--]--> Configuration Procedure <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_1-preliminary-preparation" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Preliminary preparation"><!--[--><!--]--> 1. Preliminary preparation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_2-add-user-android-users-please-ignore-this-section" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. Add user (Android users please ignore this section)"><!--[--><!--]--> 2. Add user (Android users please ignore this section) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_3-configure-and-run-xray-and-configure-iptables-rules" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. Configure and run Xray, and configure iptables rules"><!--[--><!--]--> 3. Configure and run Xray, and configure iptables rules <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#steps" class="router-link-active router-link-exact-active sidebar-item" aria-label="Steps"><!--[--><!--]--> Steps <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_1-finish-preliminary-preparation-and-add-user" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Finish Preliminary preparation and Add user"><!--[--><!--]--> 1. Finish Preliminary preparation and Add user <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_2-preparing-xray-profiles" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. Preparing Xray profiles"><!--[--><!--]--> 2. Preparing Xray profiles <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_3-configuring-the-maximum-number-of-open-files-and-run-the-xray-client" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. Configuring the maximum number of open files and run the Xray client"><!--[--><!--]--> 3. Configuring the maximum number of open files and run the Xray client <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Xray-docs-next/en/document/level-2/iptables_gid.html#_4-setting-up-iptables-rules" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. Setting up iptables rules"><!--[--><!--]--> 4. Setting up iptables rules <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/Xray-docs-next/en/document/level-2/redirect.html" class="sidebar-item" aria-label="出站流量重定向"><!--[--><!--]--> 出站流量重定向 <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-2/warp.html" class="sidebar-item" aria-label="Enhancing Proxy Security with Cloudflare Warp"><!--[--><!--]--> Enhancing Proxy Security with Cloudflare Warp <!--[--><!--]--></a><!----></li><li><a href="/Xray-docs-next/en/document/level-2/traffic_stats.html" class="sidebar-item" aria-label="流量统计"><!--[--><!--]--> 流量统计 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="transparent-proxy-to-circumvent-xray-traffic-via-gid" tabindex="-1"><a class="header-anchor" href="#transparent-proxy-to-circumvent-xray-traffic-via-gid"><span>Transparent proxy to circumvent Xray traffic via GID</span></a></h1><p>In the existing transparent proxy configuration(<strong><a href="https://guide.v2fly.org/app/transparent_proxy.html" target="_blank" rel="noopener noreferrer">New V2Ray vernacular tutorial on transparent proxy<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong> 、 <strong><a href="https://guide.v2fly.org/app/tproxy.html" target="_blank" rel="noopener noreferrer">New V2Ray vernacular tutorial on transparent proxy (TProxy)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong> 、 <strong><a href="/Xray-docs-next/en/document/level-2/tproxy.html" class="">Transparent proxy（TProxy）configuration tutorial</a></strong>)tutorials, the circumvention of Xray traffic is achieved by using mark. That is, mark outbound traffics and set up iptables rules which directly connect traffics corresponding to the mark, to circumvent the Xray traffic and prevent loop back.</p><p>There are several problems with this method:</p><ol><li><p><strong><a href="https://github.com/v2ray/v2ray-core/issues/2621" target="_blank" rel="noopener noreferrer">Inexplicable traffic into PREROUTING chain<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong></p></li><li><p>Android has its own mark mechanism and this solution is not available on Android</p></li></ol><p>The solution in this tutorial does not require a mark setting and has a higher theoretical performance, as well as not having the problems mentioned above.</p><h2 id="ideas" tabindex="-1"><a class="header-anchor" href="#ideas"><span>Ideas</span></a></h2><p>TProxy traffic can only be received by users with root privileges (uid==0) or other users with CAP_NET_ADMIN privileges.</p><p>The iptables rules can separate network traffic by uid (user id) and gid (user group id). Let Xray run on a user with uid==0 but gid!=0. Set the iptables rule to not proxy traffic for that gid to circumvent Xray traffic.</p><h2 id="configuration-procedure" tabindex="-1"><a class="header-anchor" href="#configuration-procedure"><span>Configuration Procedure</span></a></h2><h3 id="_1-preliminary-preparation" tabindex="-1"><a class="header-anchor" href="#_1-preliminary-preparation"><span>1. Preliminary preparation</span></a></h3><p><strong>Android</strong></p><ol><li><p>System has root privilege.</p></li><li><p>Install <strong><a href="https://play.google.com/store/apps/details?id=stericson.busybox" target="_blank" rel="noopener noreferrer">busybox<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong></p></li><li><p>There is a terminal that can execute commands, you can use adb shell, termux etc.</p></li></ol><p><strong>Other Linux system</strong></p><p>Need sudo, iptables-tproxy module and iptables-extra module。</p><p>Usually the system comes with these functions. If you are using openwrt, you will need to run the following command:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>opkg <span class="token function">install</span> <span class="token function">sudo</span> iptables-mod-tproxy iptables-mod-extra
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Also attached are some common dependencies for openwrt, the lack of which may prevent Xray from running</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>opkg <span class="token function">install</span> libopenssl ca-certificates
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-add-user-android-users-please-ignore-this-section" tabindex="-1"><a class="header-anchor" href="#_2-add-user-android-users-please-ignore-this-section"><span>2. Add user (Android users please ignore this section)</span></a></h3><p>Android does not support managing users by modifying the /etc/passwd file, please ignore it and go straight to the next step.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">grep</span> <span class="token parameter variable">-qw</span> xray_tproxy /etc/passwd <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;xray_tproxy:x:0:23333:::&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/passwd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>where xray_tproxy is the username, 0 is the uid and 23333 is the gid, the username and gid can be set by yourself, the uid must be 0. To check if the user was added successfully, run</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token parameter variable">-u</span> xray_tproxy <span class="token function">id</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The result displayed should be uid 0 and gid 23333.</p><h3 id="_3-configure-and-run-xray-and-configure-iptables-rules" tabindex="-1"><a class="header-anchor" href="#_3-configure-and-run-xray-and-configure-iptables-rules"><span>3. Configure and run Xray, and configure iptables rules</span></a></h3><p>In the existing transparent proxy configuration(<strong><a href="https://guide.v2fly.org/app/transparent_proxy.html" target="_blank" rel="noopener noreferrer">New V2Ray vernacular tutorial on transparent proxy<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong> 、 <strong><a href="https://guide.v2fly.org/app/tproxy.html" target="_blank" rel="noopener noreferrer">New V2Ray vernacular tutorial on transparent proxy (TProxy)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong> 、 <strong><a href="../tproxy">Transparent proxy（TProxy）configuration tutorial</a></strong>)tutorials, modify:</p><ol><li><p>Modify the json configuration file: remove mark-related content</p></li><li><p>Modify the iptables rule to remove the mark-related content and add the option at the OUTPUT chain application rule: <code>-m owner ! --gid-owner 23333</code></p></li></ol><p>e.g.:</p><p><code>iptables -t mangle -A OUTPUT -j XRAY_SELF</code></p><p>Change to</p><p><code>iptables -t mangle -A OUTPUT -m owner ! --gid-owner 23333 -j XRAY_SELF</code></p><ol><li>Modify the way you run Xray so that it runs on a user with uid 0 and gid 23333, refer to <a href="#_3-configure-and-run-xray-and-configure-iptables-rules">here</a>.</li></ol><h2 id="steps" tabindex="-1"><a class="header-anchor" href="#steps"><span>Steps</span></a></h2><p>The following provides a complete configuration process for implementing the tproxy global proxy</p><h3 id="_1-finish-preliminary-preparation-and-add-user" tabindex="-1"><a class="header-anchor" href="#_1-finish-preliminary-preparation-and-add-user"><span>1. Finish <strong><a href="#_1-preliminary-preparation">Preliminary preparation</a></strong> and <strong><a href="#_2-add-user-android-users-please-ignore-this-section">Add user</a></strong></span></a></h3><h3 id="_2-preparing-xray-profiles" tabindex="-1"><a class="header-anchor" href="#_2-preparing-xray-profiles"><span>2. Preparing Xray profiles</span></a></h3><p>Configure Xray to listen to 12345 at dokodemo-door, turn on followRedirect and tproxy, no sniffing required:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">12345</span><span class="token punctuation">,</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dokodemo-door&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tcp,udp&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;followRedirect&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;streamSettings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;sockopt&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;tproxy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tproxy&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token comment">// Your server configuration</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-configuring-the-maximum-number-of-open-files-and-run-the-xray-client" tabindex="-1"><a class="header-anchor" href="#_3-configuring-the-maximum-number-of-open-files-and-run-the-xray-client"><span>3. Configuring the maximum number of open files and run the Xray client</span></a></h3><p>About the maximum number of open files, see: <strong><a href="https://guide.v2fly.org/app/tproxy.html#%E8%A7%A3%E5%86%B3-too-many-open-files-%E9%97%AE%E9%A2%98" target="_blank" rel="noopener noreferrer">too many open files issues<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span></a></strong></p><p>The current Xray server installed with the official script has the maximum number of open files automatically configured, so no further changes are required.</p><p><strong>Android</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-SHn</span> <span class="token number">1000000</span>
setuidgid <span class="token number">0</span>:23333 <span class="token string">&quot;Command to run Xray&quot;</span><span class="token operator">&amp;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Other Linux system</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-SHn</span> <span class="token number">1000000</span>
<span class="token function">sudo</span> <span class="token parameter variable">-u</span> xray_tproxy <span class="token string">&quot;Command to run Xray&quot;</span><span class="token operator">&amp;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>e.g.:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-SHn</span> <span class="token number">1000000</span>
<span class="token function">sudo</span> <span class="token parameter variable">-u</span> xray_tproxy xray <span class="token parameter variable">-c</span> /etc/xray/config.json <span class="token operator">&amp;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><em>The first command:</em></p><p>Change the maximum number of open files, valid only for the current terminal and to be run every time before starting Xray, this command is to set the maximum number of open files for the client.</p><p><em>The second command:</em></p><p>Run the Xray client as a user with uid 0 and gid not 0, followed by &amp; for running in the background.</p><p><strong>Check if the maximum number of open files is set successfully</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">cat</span> /proc/<span class="token string">&quot;Xray&#39;s pid&quot;</span>/limits
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Find max open files, which should be the value you set. Xray&#39;s pid can be obtained by running <code>ps</code> or <code>ps -aux</code> or <code>ps -a</code></p><p>Both the server and client side should be checked.</p><h3 id="_4-setting-up-iptables-rules" tabindex="-1"><a class="header-anchor" href="#_4-setting-up-iptables-rules"><span>4. Setting up iptables rules</span></a></h3><p><strong>Proxy ipv4</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">ip</span> rule <span class="token function">add</span> fwmark <span class="token number">1</span> table <span class="token number">100</span>
<span class="token function">ip</span> route <span class="token function">add</span> <span class="token builtin class-name">local</span> <span class="token number">0.0</span>.0.0/0 dev lo table <span class="token number">100</span>

<span class="token comment"># Proxy LAN devices</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-N</span> XRAY
<span class="token comment"># &quot;ipv4 segment where the gateway is located&quot; is obtained by running the command &quot;ip address | grep -w inet | awk &#39;{print $2}&#39;&quot;, usually there are multiple</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY <span class="token parameter variable">-d</span> <span class="token string">&quot;first ipv4 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY <span class="token parameter variable">-d</span> <span class="token string">&quot;second ipv4 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN

<span class="token comment"># If the gateway is used as the primary router, add this line, see: [Other considerations for transparent proxy of iptables](https://xtls.github.io/en/documents/level-2/transparent_proxy/transparent_proxy/#proxy-ipv6)</span>
<span class="token comment"># The &quot;gateway LAN_IPv4 address segment&quot;, obtained by running the command &quot;ip address | grep -w &quot;inet&quot; | awk &#39;{print $2}&#39;&quot;, is one of the results</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY <span class="token operator">!</span> <span class="token parameter variable">-s</span> <span class="token string">&quot;gateway LAN_IPv4 address segment&quot;</span> <span class="token parameter variable">-j</span> RETURN

<span class="token comment"># Mark 1 for TCP and forward to port 12345</span>
<span class="token comment"># mark can only be set to 1 for the traffic to be accepted by the Xray dokodemo-door</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-j</span> TPROXY --on-port <span class="token number">12345</span> --tproxy-mark <span class="token number">1</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY <span class="token parameter variable">-p</span> udp <span class="token parameter variable">-j</span> TPROXY --on-port <span class="token number">12345</span> --tproxy-mark <span class="token number">1</span>
<span class="token comment"># Apply rules</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-j</span> XRAY

<span class="token comment"># Proxy gateway itself</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-N</span> XRAY_MASK
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY_MASK <span class="token parameter variable">-d</span> <span class="token string">&quot;the first ipv4 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY_MASK <span class="token parameter variable">-d</span> <span class="token string">&quot;the second ipv4 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN

iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY_MASK <span class="token parameter variable">-j</span> MARK --set-mark <span class="token number">1</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-m</span> owner <span class="token operator">!</span> --gid-owner <span class="token number">23333</span> <span class="token operator">!</span> <span class="token parameter variable">-p</span> icmp <span class="token parameter variable">-j</span> XRAY_MASK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Proxy ipv6 (optional)</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">ip</span> <span class="token parameter variable">-6</span> rule <span class="token function">add</span> fwmark <span class="token number">1</span> table <span class="token number">106</span>
<span class="token function">ip</span> <span class="token parameter variable">-6</span> route <span class="token function">add</span> <span class="token builtin class-name">local</span> ::/0 dev lo table <span class="token number">106</span>

<span class="token comment"># Proxy LAN devices</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-N</span> XRAY6
<span class="token comment"># The &quot;ipv6 segment where the gateway is located&quot; is obtained by running the command &quot;ip address | grep -w inet6 | awk &#39;{print $2}&#39;&quot;.</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6 <span class="token parameter variable">-d</span> <span class="token string">&quot;the first ipv6 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6 <span class="token parameter variable">-d</span> <span class="token string">&quot;the second ipv6 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN

<span class="token comment"># If the gateway is used as the primary router, add this line, see: [Other considerations for transparent proxy of iptables](https://xtls.github.io/en/documents/level-2/transparent_proxy/transparent_proxy/#proxy-ipv6)</span>
<span class="token comment"># The &quot;gateway LAN_IPv6 address segment&quot;, obtained by running the command &quot;ip address | grep -w &quot;inet6&quot; | awk &#39;{print $2}&#39;&quot;, is one of the results</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6 <span class="token operator">!</span> <span class="token parameter variable">-s</span> <span class="token string">&quot;gateway LAN_IPv6 address segment&quot;</span> <span class="token parameter variable">-j</span> RETURN

ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6 <span class="token parameter variable">-p</span> udp <span class="token parameter variable">-j</span> TPROXY --on-port <span class="token number">12345</span> --tproxy-mark <span class="token number">1</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-j</span> TPROXY --on-port <span class="token number">12345</span> --tproxy-mark <span class="token number">1</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-j</span> XRAY6

<span class="token comment"># Proxy gateway itself</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-N</span> XRAY6_MASK
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6_MASK <span class="token parameter variable">-d</span> <span class="token string">&quot;the first ipv6 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6_MASK <span class="token parameter variable">-d</span> <span class="token string">&quot;the second ipv6 segment where the gateway is located&quot;</span> <span class="token parameter variable">-j</span> RETURN

ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> XRAY6_MASK <span class="token parameter variable">-j</span> MARK --set-mark <span class="token number">1</span>
ip6tables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-m</span> owner <span class="token operator">!</span> --gid-owner <span class="token number">23333</span> <span class="token operator">!</span> <span class="token parameter variable">-p</span> icmp <span class="token parameter variable">-j</span> XRAY6_MASK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/xtls/Xray-docs-next/edit/main/docs/en/document/level-2/iptables_gid.md" rel="noopener noreferrer" target="_blank" aria-label="Help us improve this page on GitHub！"><!--[--><!--]--> Help us improve this page on GitHub！ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new tag</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 82594500+hmol233@users.noreply.github.com">hmol233</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 30682790+R3pl4c3r@users.noreply.github.com">R3pl4c3r</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><span class="prev"><a href="/Xray-docs-next/en/document/level-2/nginx_or_haproxy_tls_tunnel.html" class="" aria-label="Nginx 或 Haproxy 搭建 TLS 隧道隐藏指纹"><!--[--><!--]--> Nginx 或 Haproxy 搭建 TLS 隧道隐藏指纹 <!--[--><!--]--></a></span><span class="next"><a href="/Xray-docs-next/en/document/level-2/redirect.html" class="" aria-label="出站流量重定向"><!--[--><!--]--> 出站流量重定向 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/Xray-docs-next/assets/app-U4p-MjZo.js" defer></script>
  </body>
</html>
