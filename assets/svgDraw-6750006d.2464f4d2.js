import{l as t,a5 as e,y as i,a7 as a}from"./mermaid.core.78045921.js";import{l as n}from"./line.e803bb7e.js";let r=0;const d=function(t){let e=t.id;return t.type&&(e+="<"+t.type+">"),e},s=function(t){let e="",i="",n="",r="",d=t.substring(0,1),s=t.substring(t.length-1,t.length);d.match(/[#+~-]/)&&(r=d);let o=/[\s\w)~]/;s.match(o)||(i=l(s));const c=""===r?0:1;let p=""===i?t.length:t.length-1;const g=(t=t.substring(c,p)).indexOf("("),h=t.indexOf(")");if(g>1&&h>g&&h<=t.length){let d=t.substring(0,g).trim();const s=t.substring(g+1,h);if(e=r+d+"("+a(s.trim())+")",h<t.length){let r=t.substring(h+1,h+2);""!==i||r.match(o)?n=t.substring(h+1).trim():(i=l(r),n=t.substring(h+2).trim()),""!==n&&(":"===n.charAt(0)&&(n=n.substring(1).trim()),n=" : "+a(n),e+=n)}}else e=r+a(t);return{displayText:e,cssStyle:i}},o=function(t,e,i,a){let n=s(e);const r=t.append("tspan").attr("x",a.padding).text(n.displayText);""!==n.cssStyle&&r.attr("style",n.cssStyle),i||r.attr("dy",a.textHeight)},l=function(t){switch(t){case"*":return"font-style:italic;";case"$":return"text-decoration:underline;";default:return""}},c={getClassTitleString:d,drawClass:function(e,i,a,n){t.debug("Rendering class ",i,a);const r=i.id,s={id:r,label:i.id,width:0,height:0},l=e.append("g").attr("id",n.db.lookUpDomId(r)).attr("class","classGroup");let c;c=i.link?l.append("svg:a").attr("xlink:href",i.link).attr("target",i.linkTarget).append("text").attr("y",a.textHeight+a.padding).attr("x",0):l.append("text").attr("y",a.textHeight+a.padding).attr("x",0);let p=!0;i.annotations.forEach((function(t){const e=c.append("tspan").text("«"+t+"»");p||e.attr("dy",a.textHeight),p=!1}));let g=d(i);const h=c.append("tspan").text(g).attr("class","title");p||h.attr("dy",a.textHeight);const x=c.node().getBBox().height,y=l.append("line").attr("x1",0).attr("y1",a.padding+x+a.dividerMargin/2).attr("y2",a.padding+x+a.dividerMargin/2),u=l.append("text").attr("x",a.padding).attr("y",x+a.dividerMargin+a.textHeight).attr("fill","white").attr("class","classText");p=!0,i.members.forEach((function(t){o(u,t,p,a),p=!1}));const f=u.node().getBBox(),b=l.append("line").attr("x1",0).attr("y1",a.padding+x+a.dividerMargin+f.height).attr("y2",a.padding+x+a.dividerMargin+f.height),w=l.append("text").attr("x",a.padding).attr("y",x+2*a.dividerMargin+f.height+a.textHeight).attr("fill","white").attr("class","classText");p=!0,i.methods.forEach((function(t){o(w,t,p,a),p=!1}));const m=l.node().getBBox();var T=" ";i.cssClasses.length>0&&(T+=i.cssClasses.join(" "));const B=l.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",m.width+2*a.padding).attr("height",m.height+a.padding+.5*a.dividerMargin).attr("class",T).node().getBBox().width;return c.node().childNodes.forEach((function(t){t.setAttribute("x",(B-t.getBBox().width)/2)})),i.tooltip&&c.insert("title").text(i.tooltip),y.attr("x2",B),b.attr("x2",B),s.width=B,s.height=m.height+a.padding+.5*a.dividerMargin,s},drawEdge:function(a,d,s,o,l){const c=function(t){switch(t){case l.db.relationType.AGGREGATION:return"aggregation";case l.db.relationType.EXTENSION:return"extension";case l.db.relationType.COMPOSITION:return"composition";case l.db.relationType.DEPENDENCY:return"dependency";case l.db.relationType.LOLLIPOP:return"lollipop"}};d.points=d.points.filter((t=>!Number.isNaN(t.y)));const p=d.points,g=n().x((function(t){return t.x})).y((function(t){return t.y})).curve(e),h=a.append("path").attr("d",g(p)).attr("id","edge"+r).attr("class","relation");let x,y,u="";o.arrowMarkerAbsolute&&(u=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,u=u.replace(/\(/g,"\\("),u=u.replace(/\)/g,"\\)")),1==s.relation.lineType&&h.attr("class","relation dashed-line"),10==s.relation.lineType&&h.attr("class","relation dotted-line"),"none"!==s.relation.type1&&h.attr("marker-start","url("+u+"#"+c(s.relation.type1)+"Start)"),"none"!==s.relation.type2&&h.attr("marker-end","url("+u+"#"+c(s.relation.type2)+"End)");const f=d.points.length;let b,w,m,T,B=i.calcLabelPosition(d.points);if(x=B.x,y=B.y,f%2!=0&&f>1){let e=i.calcCardinalityPosition("none"!==s.relation.type1,d.points,d.points[0]),a=i.calcCardinalityPosition("none"!==s.relation.type2,d.points,d.points[f-1]);t.debug("cardinality_1_point "+JSON.stringify(e)),t.debug("cardinality_2_point "+JSON.stringify(a)),b=e.x,w=e.y,m=a.x,T=a.y}if(void 0!==s.title){const t=a.append("g").attr("class","classLabel"),e=t.append("text").attr("class","label").attr("x",x).attr("y",y).attr("fill","red").attr("text-anchor","middle").text(s.title);window.label=e;const i=e.node().getBBox();t.insert("rect",":first-child").attr("class","box").attr("x",i.x-o.padding/2).attr("y",i.y-o.padding/2).attr("width",i.width+o.padding).attr("height",i.height+o.padding)}if(t.info("Rendering relation "+JSON.stringify(s)),void 0!==s.relationTitle1&&"none"!==s.relationTitle1){a.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",b).attr("y",w).attr("fill","black").attr("font-size","6").text(s.relationTitle1)}if(void 0!==s.relationTitle2&&"none"!==s.relationTitle2){a.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",m).attr("y",T).attr("fill","black").attr("font-size","6").text(s.relationTitle2)}r++},drawNote:function(e,i,a,n){t.debug("Rendering note ",i,a);const r=i.id,d={id:r,text:i.text,width:0,height:0},s=e.append("g").attr("id",r).attr("class","classGroup");let o=s.append("text").attr("y",a.textHeight+a.padding).attr("x",0);const l=JSON.parse(`"${i.text}"`).split("\n");l.forEach((function(e){t.debug(`Adding line: ${e}`),o.append("tspan").text(e).attr("class","title").attr("dy",a.textHeight)}));const c=s.node().getBBox(),p=s.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",c.width+2*a.padding).attr("height",c.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin).node().getBBox().width;return o.node().childNodes.forEach((function(t){t.setAttribute("x",(p-t.getBBox().width)/2)})),d.width=p,d.height=c.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin,d},parseMember:s};export{s as p,c as s};
