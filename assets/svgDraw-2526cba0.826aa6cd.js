import{l as t,a2 as e,y as i,a3 as a}from"./mermaid.core.808c8fa7.js";import{l as n}from"./line.beb11e49.js";let r=0;const d=function(t){let e=t.match(/^([#+~-])?(\w+)(~\w+~|\[])?\s+(\w+) *([$*])?$/),i=t.match(/^([#+|~-])?(\w+) *\( *(.*)\) *([$*])? *(\w*[[\]|~]*\s*\w*~?)$/);return e&&!i?s(e):i?o(i):l(t)},s=function(t){let e="",i="";try{let n=t[1]?t[1].trim():"",r=t[2]?t[2].trim():"",d=t[3]?a(t[3].trim()):"",s=t[4]?t[4].trim():"",o=t[5]?t[5].trim():"";i=n+r+d+" "+s,e=p(o)}catch(n){i=t}return{displayText:i,cssStyle:e}},o=function(t){let e="",i="";try{let n=t[1]?t[1].trim():"",r=t[2]?t[2].trim():"",d=t[3]?a(t[3].trim()):"",s=t[4]?t[4].trim():"";i=n+r+"("+d+")"+(t[5]?" : "+a(t[5]).trim():""),e=p(s)}catch(n){i=t}return{displayText:i,cssStyle:e}},l=function(t){let e="",i="",n="",r=t.indexOf("("),d=t.indexOf(")");if(r>1&&d>r&&d<=t.length){let s="",o="",l=t.substring(0,1);l.match(/\w/)?o=t.substring(0,r).trim():(l.match(/[#+~-]/)&&(s=l),o=t.substring(1,r).trim());const c=t.substring(r+1,d);t.substring(d+1,1),i=p(t.substring(d+1,d+2)),e=s+o+"("+a(c.trim())+")",d<t.length&&(n=t.substring(d+2).trim(),""!==n&&(n=" : "+a(n),e+=n))}else e=a(t);return{displayText:e,cssStyle:i}},c=function(t,e,i,a){let n=d(e);const r=t.append("tspan").attr("x",a.padding).text(n.displayText);""!==n.cssStyle&&r.attr("style",n.cssStyle),i||r.attr("dy",a.textHeight)},p=function(t){switch(t){case"*":return"font-style:italic;";case"$":return"text-decoration:underline;";default:return""}},g={drawClass:function(e,i,a,n){t.debug("Rendering class ",i,a);const r=i.id,d={id:r,label:i.id,width:0,height:0},s=e.append("g").attr("id",n.db.lookUpDomId(r)).attr("class","classGroup");let o;o=i.link?s.append("svg:a").attr("xlink:href",i.link).attr("target",i.linkTarget).append("text").attr("y",a.textHeight+a.padding).attr("x",0):s.append("text").attr("y",a.textHeight+a.padding).attr("x",0);let l=!0;i.annotations.forEach((function(t){const e=o.append("tspan").text("«"+t+"»");l||e.attr("dy",a.textHeight),l=!1}));let p=i.id;void 0!==i.type&&""!==i.type&&(p+="<"+i.type+">");const g=o.append("tspan").text(p).attr("class","title");l||g.attr("dy",a.textHeight);const h=o.node().getBBox().height,x=s.append("line").attr("x1",0).attr("y1",a.padding+h+a.dividerMargin/2).attr("y2",a.padding+h+a.dividerMargin/2),y=s.append("text").attr("x",a.padding).attr("y",h+a.dividerMargin+a.textHeight).attr("fill","white").attr("class","classText");l=!0,i.members.forEach((function(t){c(y,t,l,a),l=!1}));const u=y.node().getBBox(),f=s.append("line").attr("x1",0).attr("y1",a.padding+h+a.dividerMargin+u.height).attr("y2",a.padding+h+a.dividerMargin+u.height),w=s.append("text").attr("x",a.padding).attr("y",h+2*a.dividerMargin+u.height+a.textHeight).attr("fill","white").attr("class","classText");l=!0,i.methods.forEach((function(t){c(w,t,l,a),l=!1}));const m=s.node().getBBox();var b=" ";i.cssClasses.length>0&&(b+=i.cssClasses.join(" "));const T=s.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",m.width+2*a.padding).attr("height",m.height+a.padding+.5*a.dividerMargin).attr("class",b).node().getBBox().width;return o.node().childNodes.forEach((function(t){t.setAttribute("x",(T-t.getBBox().width)/2)})),i.tooltip&&o.insert("title").text(i.tooltip),x.attr("x2",T),f.attr("x2",T),d.width=T,d.height=m.height+a.padding+.5*a.dividerMargin,d},drawEdge:function(a,d,s,o,l){const c=function(t){switch(t){case l.db.relationType.AGGREGATION:return"aggregation";case l.db.relationType.EXTENSION:return"extension";case l.db.relationType.COMPOSITION:return"composition";case l.db.relationType.DEPENDENCY:return"dependency";case l.db.relationType.LOLLIPOP:return"lollipop"}};d.points=d.points.filter((t=>!Number.isNaN(t.y)));const p=d.points,g=n().x((function(t){return t.x})).y((function(t){return t.y})).curve(e),h=a.append("path").attr("d",g(p)).attr("id","edge"+r).attr("class","relation");let x,y,u="";o.arrowMarkerAbsolute&&(u=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,u=u.replace(/\(/g,"\\("),u=u.replace(/\)/g,"\\)")),1==s.relation.lineType&&h.attr("class","relation dashed-line"),10==s.relation.lineType&&h.attr("class","relation dotted-line"),"none"!==s.relation.type1&&h.attr("marker-start","url("+u+"#"+c(s.relation.type1)+"Start)"),"none"!==s.relation.type2&&h.attr("marker-end","url("+u+"#"+c(s.relation.type2)+"End)");const f=d.points.length;let w,m,b,T,B=i.calcLabelPosition(d.points);if(x=B.x,y=B.y,f%2!=0&&f>1){let e=i.calcCardinalityPosition("none"!==s.relation.type1,d.points,d.points[0]),a=i.calcCardinalityPosition("none"!==s.relation.type2,d.points,d.points[f-1]);t.debug("cardinality_1_point "+JSON.stringify(e)),t.debug("cardinality_2_point "+JSON.stringify(a)),w=e.x,m=e.y,b=a.x,T=a.y}if(void 0!==s.title){const t=a.append("g").attr("class","classLabel"),e=t.append("text").attr("class","label").attr("x",x).attr("y",y).attr("fill","red").attr("text-anchor","middle").text(s.title);window.label=e;const i=e.node().getBBox();t.insert("rect",":first-child").attr("class","box").attr("x",i.x-o.padding/2).attr("y",i.y-o.padding/2).attr("width",i.width+o.padding).attr("height",i.height+o.padding)}if(t.info("Rendering relation "+JSON.stringify(s)),void 0!==s.relationTitle1&&"none"!==s.relationTitle1){a.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",w).attr("y",m).attr("fill","black").attr("font-size","6").text(s.relationTitle1)}if(void 0!==s.relationTitle2&&"none"!==s.relationTitle2){a.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",b).attr("y",T).attr("fill","black").attr("font-size","6").text(s.relationTitle2)}r++},drawNote:function(e,i,a,n){t.debug("Rendering note ",i,a);const r=i.id,d={id:r,text:i.text,width:0,height:0},s=e.append("g").attr("id",r).attr("class","classGroup");let o=s.append("text").attr("y",a.textHeight+a.padding).attr("x",0);const l=JSON.parse(`"${i.text}"`).split("\n");l.forEach((function(e){t.debug(`Adding line: ${e}`),o.append("tspan").text(e).attr("class","title").attr("dy",a.textHeight)}));const c=s.node().getBBox(),p=s.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",c.width+2*a.padding).attr("height",c.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin).node().getBBox().width;return o.node().childNodes.forEach((function(t){t.setAttribute("x",(p-t.getBBox().width)/2)})),d.width=p,d.height=c.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin,d},parseMember:d};export{d as p,g as s};
