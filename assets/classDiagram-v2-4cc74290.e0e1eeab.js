import{p as e,d as t,s as a}from"./styles-bd38c0ff.0daee8b1.js";import{l,c as o,h as s,y as i,t as n,j as r,r as d,o as c,p}from"./mermaid.core.dd74ef8a.js";import{G as y}from"./index.ca0c3795.js";import{r as f}from"./index-64e46a5f.d016ebf4.js";import"./app.1838d718.js";import"./isPlainObject.9fc8c8e3.js";import"./array.999c8e45.js";import"./constant.4f073c13.js";import"./edges-02da71a2.c9693926.js";import"./svgDraw-87c143cd.0e8e9c67.js";const b=e=>r.sanitizeText(e,o());let g={dividerMargin:10,padding:5,textHeight:10};function h(e){let t;switch(e){case 0:t="aggregation";break;case 1:t="extension";break;case 2:t="composition";break;case 3:t="dependency";break;case 4:t="lollipop";break;default:t="none"}return t}const u={parser:e,db:t,renderer:{setConf:function(e){Object.keys(e).forEach((function(t){g[t]=e[t]}))},draw:function(e,t,a,u){l.info("Drawing class - ",t);const m=o().flowchart,x=o().securityLevel;l.info("config:",m);const w=m.nodeSpacing||50,S=m.rankSpacing||50,T=new y({multigraph:!0,compound:!0}).setGraph({rankdir:u.db.getDirection(),nodesep:w,ranksep:S,marginx:8,marginy:8}).setDefaultEdgeLabel((function(){return{}})),k=u.db.getClasses(),v=u.db.getRelations(),j=u.db.getNotes();let L;l.info(v),function(e,t,a,s){const i=Object.keys(e);l.info("keys:",i),l.info(e),i.forEach((function(a){const i=e[a];let n="";i.cssClasses.length>0&&(n=n+" "+i.cssClasses.join(" "));const r={labelStyle:""};let d=void 0!==i.text?i.text:i.id,c="";switch(i.type){case"class":c="class_box";break;default:c="class_box"}t.setNode(i.id,{labelStyle:r.labelStyle,shape:c,labelText:b(d),classData:i,rx:0,ry:0,class:n,style:r.style,id:i.id,domId:i.domId,tooltip:s.db.getTooltip(i.id)||"",haveCallback:i.haveCallback,link:i.link,width:"group"===i.type?500:void 0,type:i.type,padding:o().flowchart.padding}),l.info("setNode",{labelStyle:r.labelStyle,shape:c,labelText:d,rx:0,ry:0,class:n,style:r.style,id:i.id,width:"group"===i.type?500:void 0,type:i.type,padding:o().flowchart.padding})}))}(k,T,0,u),function(e,t){const a=o().flowchart;let s=0;e.forEach((function(i){s++;const n={classes:"relation"};n.pattern=1==i.relation.lineType?"dashed":"solid",n.id="id"+s,"arrow_open"===i.type?n.arrowhead="none":n.arrowhead="normal",l.info(n,i),n.startLabelRight="none"===i.relationTitle1?"":i.relationTitle1,n.endLabelLeft="none"===i.relationTitle2?"":i.relationTitle2,n.arrowTypeStart=h(i.relation.type1),n.arrowTypeEnd=h(i.relation.type2);let y="",f="";if(void 0!==i.style){const e=p(i.style);y=e.style,f=e.labelStyle}else y="fill:none";n.style=y,n.labelStyle=f,void 0!==i.interpolate?n.curve=d(i.interpolate,c):void 0!==e.defaultInterpolate?n.curve=d(e.defaultInterpolate,c):n.curve=d(a.curve,c),i.text=i.title,void 0===i.text?void 0!==i.style&&(n.arrowheadStyle="fill: #333"):(n.arrowheadStyle="fill: #333",n.labelpos="c",o().flowchart.htmlLabels?(n.labelType="html",n.label='<span class="edgeLabel">'+i.text+"</span>"):(n.labelType="text",n.label=i.text.replace(r.lineBreakRegex,"\n"),void 0===i.style&&(n.style=n.style||"stroke: #333; stroke-width: 1.5px;fill:none"),n.labelStyle=n.labelStyle.replace("color:","fill:"))),t.setEdge(i.id1,i.id2,n,s)}))}(v,T),function(e,t,a,s){l.info(e),e.forEach((function(e,i){const n=e,r="",p="";let y=n.text,f="note";if(t.setNode(n.id,{labelStyle:r,shape:f,labelText:b(y),noteData:n,rx:0,ry:0,class:"",style:p,id:n.id,domId:n.id,tooltip:"",type:"note",padding:o().flowchart.padding}),l.info("setNode",{labelStyle:r,shape:f,labelText:y,rx:0,ry:0,style:p,id:n.id,type:"note",padding:o().flowchart.padding}),!n.class||!(n.class in s))return;const h=a+i,u={classes:"relation",pattern:"dotted"};u.id=`edgeNote${h}`,u.arrowhead="none",l.info(`Note edge: ${JSON.stringify(u)}, ${JSON.stringify(n)}`),u.startLabelRight="",u.endLabelLeft="",u.arrowTypeStart="none",u.arrowTypeEnd="none",u.style="fill:none",u.labelStyle="",u.curve=d(g.curve,c),t.setEdge(n.id,n.class,u,h)}))}(j,T,v.length+1,k),"sandbox"===x&&(L=s("#i"+t));const D=s("sandbox"===x?L.nodes()[0].contentDocument.body:"body"),E=D.select(`[id="${t}"]`),N=D.select("#"+t+" g");if(f(N,T,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",t),i.insertTitle(E,"classTitleText",m.titleTopMargin,u.db.getDiagramTitle()),n(T,E,m.diagramPadding,m.useMaxWidth),!m.htmlLabels){const e="sandbox"===x?L.nodes()[0].contentDocument:document,a=e.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const t of a){const a=t.getBBox(),l=e.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("rx",0),l.setAttribute("ry",0),l.setAttribute("width",a.width),l.setAttribute("height",a.height),t.insertBefore(l,t.firstChild)}}}},styles:a,init:e=>{e.class||(e.class={}),e.class.arrowMarkerAbsolute=e.arrowMarkerAbsolute,t.clear()}};export{u as diagram};
